\documentclass{article}
\usepackage[english]{babel} 
\usepackage[utf8x]{inputenc}
\usepackage[final]{microtype}
\usepackage[bottom]{footmisc}
%% Hyperlinks 
\usepackage[hidelinks]{hyperref}
\hypersetup{
  colorlinks,
  linktoc=page,
  linkcolor=blue,
  citecolor=blue,
  urlcolor=blue
}
%% Graphics
\usepackage{graphicx}
\usepackage{float}

\usepackage{enumerate}
% Math packages
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{amssymb}
\usepackage{mathpartir}

% Proof system
\usepackage{amsthm}
% \usepackage{xpatch}
\makeatletter

% paper margins
\usepackage[tmargin=1in,lmargin=1in,rmargin=1in,bmargin=1in]{geometry}
% citations
\usepackage{cite}
% Graphs
\usepackage{tikz}
\usetikzlibrary{quotes,angles}

\usepackage[ruled,vlined,linesnumbered]{algorithm2e}

% multiple colums
\usepackage{multicol}

% Custom commands
\newcommand\restr[2]{{% we make the whole thing an ordinary symbol
    \left.\kern-\nulldelimiterspace % automatically resize the bar with \right
      #1 % the function
      \vphantom{\big|} % pretend it's a little taller at normal size
    \right|_{#2} % this is the delimiter
  }}
\newcommand{\kw}[1]{{\mathsf{#1}}\xspace}
\newcommand{\tgd}{\kw{TGD}}
\newcommand{\var}{\kw{Var}}
\newcommand{\body}{\beta}
\newcommand{\head}{\eta}
\newcommand{\guard}{G}
\newcommand{\guards}{\mathcal{G}}
\newcommand{\hnf}{\kw{HNF}}
\newcommand{\sk}{\kw{SK}}
\newcommand{\vnf}{\kw{VNF}}
\newcommand{\rphi}{\varphi}
\newcommand{\workingSet}{\mathcal{W}}
\newcommand{\fullSet}{\mathcal{F}}
\newcommand{\nonFullSet}{\mathcal{N}}
\newcommand{\comment}[1]{\tcp*[f]{#1}}
\newcommand{\evolve}{\kw{EVOLVE}}
\newcommand{\hyperresolve}{\kw{HYPERRESOLVE}}
\newcommand{\evolvedSet}{\mathcal{E}}
\newcommand{\hgsat}{\kw{HyperSat}}
\newcommand{\vars}{\kw{Vars}}

\pagestyle{plain}

% Title page settings

% Line breaks after paragraph
% double line spacing
% \linespread{1.5}
% ------------------------------------------------------------------------------
\begin{document}
\begin{algorithm}[H]
  \DontPrintSemicolon
  \SetAlgoLined
  \SetKwProg{Fn}{Function}{: }{}
  \SetKwInOut{Input}{Input}\SetKwInOut{Output}{Output}
  \Fn{$\hgsat$}{
    \Input{Guarded TGDs $\Sigma$}
    \Output{Atomic rewriting of $\Sigma$}
    \BlankLine
    $\workingSet = \vnf\bigl(\sk(\Sigma)\bigr)$\comment{working set}\;
    $\fullSet = \nonFullSet =\emptyset$\comment{full and non-full set}\;
    \While{$\workingSet\neq\emptyset$}{
      Let $\sigma$ be a rule in $\workingSet$\;
      \eIf{$\sigma$ is full}{
        $\fullSet = \fullSet\cup\{\sigma\}$\;
        $\evolvedSet = \hyperresolve(\nonFullSet, \sigma)$\;
      }{
        % \comment{an index }\;
        $\nonFullSet = \nonFullSet\cup\{\sigma\}$\;
	$\evolvedSet = \bigcup_{\rho \in \fullSet} \hyperresolve(\nonFullSet, \rho)$\;
      }
      $\workingSet = \workingSet\cup\evolvedSet\setminus\bigl(\fullSet\cup\nonFullSet\bigr)$\;
    }
    \KwRet{$\fullSet$}\;
  }\;

  \Fn{$\hyperresolve$}{
    \Input{Non-full set $\nonFullSet$ and full $\rho=\body\rightarrow\head$}
    \Output{hyperresolutions of $\rho$ with rules from $\nonFullSet$}
    \BlankLine
    Let $\evolvedSet = \emptyset$\;
    Let $S=(B_1, \dots, B_n)$ be a tuple such that $\body = \{ B_1, \dots, B_n\}$\;
    Let $P= \nonFullSet^{n}$\;
    \ForEach{$(\lambda_1, \dots, \lambda_n) \in P$}{
      Rename variables $\lambda_1, \dots, \lambda_n$ such that $\var(\lambda_i) \cap \var(\lambda_j) = \emptyset$, for $i \neq j$ \comment{could be done on P directly}\;
      Let $S'=(H_1', \dots, H_n')$ be the tuple defined such that for  $1 \leq i \leq n, H_i'$ is the head atom of $\lambda_i$\;
      \If{there exists $\theta$ a mgu  $S$ and $S'$ }{
        Let $\body_i'$ be the body of $\lambda_i$\;
        $\beta'' = \cup_{1\leq i \leq n} \body_i'\theta$\;
        $\head'' = \head \theta$\;
        $\evolvedSet = \evolvedSet \cup \vnf\left (\sk(\body'' \rightarrow \head'')\right )$\;
      }
    }
    \KwRet{$\evolvedSet$}\;
  }
  \caption{Unoptimized Hyperresolution Saturation}
\end{algorithm}
\end{document}
